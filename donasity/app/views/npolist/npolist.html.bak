<!DOCTYPE html>
<html lang="en">
<head>
{include="top/head"}
</head>
<body id="body">
{include="top/top"}
<link type="text/css" rel="stylesheet" href='{#RESOURCES#}css/non-profits-search.css' />
<!--<link rel="stylesheet" type="text/css" href='{#RESOURCES#}css/jquery-ui.css'/>-->
<script type="text/javascript" src='{#RESOURCES#}js/npolist.js'></script>
<script src='{#RESOURCES#}js/jquery-ui.js'></script>
<script type="text/livescript">
$(document).ready(function(){
	
	$('.sarchsectionkeyword').keypress(function(event) {
		if (event.which == 13) {
			$('#titlesearch').trigger('click');
		 }
	});
	
	$('.locationkeyword').keypress(function(event) {
		if (event.which == 13) {
			$('#locationsearch').trigger('click');
		 }
	});
	
	$(".category").click(function(){
		Category	= $(this).attr('id');
		ExistCategories	= $('#category').val();
		if(ExistCategories != ""){
			ExistArr	= ExistCategories.split('||');
			NewArray	= new Array(Category);
			var NewCategories = ExistArr.concat(NewArray); 
		}
		else
		{
			NewArray	= new Array(Category);
			NewCategories	= NewArray;
		}
		$('#category').val(NewCategories.join('||'));
		SendUrl();
	});	
	
	$(".RemoveCat").click(function(){
		CatStr	= $(this).attr("id");
		ExistCategories	= $('#category').val();
		ExistCategoriesArr	= ExistCategories.split('||');
		var index = ExistCategoriesArr.indexOf(CatStr);
		if (index > -1) {
			ExistCategoriesArr.splice(index, 1);
		}
		$('#category').val(ExistCategoriesArr.join('||'));
		SendUrl();
	});
	
	//reset location
	$('#resetlocation').click(function(){
		$('#location').val('');
		SendUrl();
	});
	
	
	//reset category
	$('#resetcat').click(function(){
		$('#category').val('');	
		SendUrl();
	});
	
	//auto complete
	$(function() {
		$( "#location" ).autocomplete(
		{ minLength: 2 },
		{
		 // source: availableTags
		  source: SITEURL+"npolist/GetLocation"
		});
    });
	//auto complete
});

function SendUrl(varnum)
{
	//var Keyword		= $('#keyword').val();
	var Keyword		= $('#keyword').val();
	var MobileKeyword = $('#searchkeyword').val();
	if(varnum==1)
	{
		Keyword = MobileKeyword;
		//$('#keyword').val('');
	}	
	var Location	= $('#location').val();
	var Category	= $('#category').val();	
	var PageNumber	= $('#pageNumber').val();
	PageNumber		= (PageNumber	== 0 || PageNumber	== "")?1:PageNumber;
	url	= SITEURL+"non-profits-search?pageNumber="+PageNumber;
	
	if(Keyword != "")
	{
		url	= url+"&&filter[keyword]="+Keyword;
	}
	if(Location != "")
	{
		url	= url+"&&filter[location]="+Location;
	}
	if(Category != "")
	{
		url	= url+"&&filter[category]="+Category;
	}
	
	window.location.href=url;
}

	
function npoformsubmit()
{
	var ActionURL	= SITEURL+"non-profits-search";
	$('#searchform').attr('action',ActionURL);
	document.searchform.submit();	
}

function Campaignformsubmit()
{
	ActionURL	= SITEURL+"fundraiser-search";
	$('#searchform').attr('action',ActionURL);
	document.searchform.submit();	
}
function reloadPage() {
    //window.location = window.location
	location.href=SITEURL+"search";
}

function GotoPage(pageNo) {
	
	jQuery('#pageNumber').val(pageNo);
	//jQuery('#searchform').submit();
	//return false;
	SendUrl();
}
</script>

<form name="searchform" id="searchform" method="get" action='{#URL#}non-profits-search'>
	<input type="hidden" name="category" id="category" value="{$SearchCategory}"/>
    <input type="hidden" name="pageNumber" id="pageNumber" />
<section class="first-section non-profits-search">
	<div class="container">
		<div class="row">
			{$pageheading}
		</div>
	</div>
</section>
<section class="section-padding search-head">
	<div class="container">
	<div class="row">
        <div class="col-md-6 col-sm-6 col-xs-12 mobile-search-section pull-right">
            <div class="main-search hidden-xs">
                <div class="form-group m-0">
                    <input type="text" name="keyword" id="keyword" placeholder="{#_SEARCH_PLACEHOLDER_#}" class="sarchsectionkeyword searchkeyword"  value="{$SearchTitle}" >
                    <button type="button" class="search-btn" id="titlesearch"><i class="fa fa-search"></i></button>
                </div>
            </div>
            <div class="search-section visible-xs-block">
                <div class="form-group clear-mobile-margin">
  <button class="search-btn" type="button" onClick="SendUrl(1)"  title="{#_SEARCH_PLACEHOLDER_ALL_PAGES_#}"><i class="fa fa-search"></i></button>
  <input type="text" name="searchkeyword" id="searchkeyword" class="searchkeyword" placeholder="{#_SEARCH_PLACEHOLDER_ALL_PAGES_#}" value="{$SearchTitle}">
                </div>
            </div>
		</div>
	</div>
</div>
</section>
<section class="section-padding cms-section search-container">
	<div class="container p-relative">
    	<div class="tab-section">
        	<ul class="list-inline oh">
            	<li><a href='{#URL#}fundraisers-search?filter[keyword]={$SearchTitle}' title="Fundraisers">{#_FUNDRAISERS_#}</a></li>
                <li class="active-tab"><a href='javascript://' title="Non-Profits"   onclick="npoformsubmit()">{#_NONPROFITS_#}</a></li>
            </ul>
        </div>
        <div class="db mobile-result-section">
        	<div class="col-md-3 col-sm-3 filter-left-section">
	            <div class="filter-section">
                    <div class="heading-2">{#_FILTER_SEARCH_#}</div>
                    <div class="mt-25 heading-2">{#_FILTER_LOCATION_#}</div>
                    <div class="mt-10 fonts-lato-bold">
                        <div class="form-group">
                            <input class="form-control locationkeyword" type="text" name="location" id="location" placeholder="{#_LOCATIONPLACEHOLDER_#}"  value="{$SearchLocation}"/>                    
                        </div>
                        <div class="select form-group">
                            <select class="form-control" name="country" id="country">
                                <option value="">All Countries</option>
                            </select>
                            <i class="arrow fa fa-caret-down"></i>                   
                        </div>
                        <button type="button" class="button-2 fonts-quicksand-bold mb-5" id="locationsearch">SUBMIT</button>
                        <div class="oh"> <a href='javascript:' id="resetlocation">{#_RESET_#}</a></div>
					</div>
                    {if="$category!=NULL"}
                    <div class="mt-25 heading-2">{#_CATEGORIES_#}</div>
                    <ul class="category-list oh">
                    	{loop="category"}
                        	<li class='category {if="in_array($value.NPOCat_ID,$CatArr)"}active-category {/if}'  id="{$value.NPOCat_ID}">
                            	<a href='javascript://'>{$value.DisplayName} {if="isset($value.cnt)"}({$value.cnt}){/if}</a>
                            </li>
                        {/loop}
                    </ul>
                    {/if}
                </div>
            </div>
            <div class="col-md-9 col-sm-9 filter-right-section">
            	{if="$SearchTitle != '' "}
                	<div class="heading-2">{#_SEARCH_RESULTS_FOR_#}: <span>"{$SearchTitle}"</span></div>
                {/if}
            	<div class="add-list mt-10">
                	<ul class="list-inline oh m-0">                    
                    {loop="category"}
                        {if="in_array($value.NPOCat_ID,$CatArr)"}
                            <li>
                                <span>
                                    {$value.DisplayName}{if="isset($value.cnt)"}({$value.cnt}){/if}
                                    <a href='javascript:' class="remove-btn" title="Click here to remove to this category"><i id="{$value.NPOCat_ID}" class="fa fa-times RemoveCat"></i></a>
                                </span>
                            </li>
                        {/if}
                    {/loop}

                    </ul>

                </div>                
                 <!-- pagination start-->
                 <div class="oh">
                    {if="count($CatArr) > 0 && count($category)>0"}
						<div class="pull-left fonts-lato-bold record-reset-btn"> <a href='javascript:' id="resetcat">{#_RESET_#}</a></div>
                    {/if}
                    <div class="pull-right record-found">
                    {if condition="count($NPOList) > 0"}
                        {if="LANG_ID == 'en'"}
                        Showing {$startRecord}-{$endRecord} of {$totalrecord} records
                        {else}
						demostraciÃ³n {$startRecord}-{$endRecord} de {$totalrecord} archivos
                        {/if}
                    {/if}
                </div>
                 </div>
                
                <!-- pagination end-->              
                <div class="oh">
                    <!-- npo listing -->
                   
                     {if="$NPOList"}
                     {loop="NPOList"}
                    <div class="category-result-box">
                        <!--<a href='{#URL#}cart/index/addcart/{$value.NPO_ID|keyEncrypt}/{if="$value.IsRegistered==1"}NPOR{else}NPONR{/if}' class="learn-more hidden-xs">{#_DONATE_#} >> </a>-->
                        <a href='{#URL#}donation_checkout/index/addcart/{$value.NPO_ID|keyEncrypt}/{if="$value.IsRegistered==1"}NPOR{else}NPONR{/if}' class="learn-more hidden-xs">{#_DONATE_#} >> </a>
                        <div class="row">
                            <div class="col-md-3 col-sm-3 col-xs-5 category-result-img">
                             {if="$value.IsRegistered"}
                             	<img src='{function="CheckImage(NPO_IMAGE_DIR,NPO_IMAGE_URL,NO_PERSON_IMAGE_REGISTERED,$value.NPOLogo)"}' alt="image" class="img-responsive" width='179px' />
                             {else}
                             	<img src='{function="CheckImage(NPO_IMAGE_DIR,NPO_IMAGE_URL,NO_PERSON_IMAGE,$value.NPOLogo)"}' alt="image" class="img-responsive" width='179px' />
                             {/if}	
                           <!--<img src='{#URL#}app/views/images/search-dummy.jpg' alt="image" class="img-responsive" />-->
                            </div>
                            <div class="result-heading">{$value.NPO_Name}</div>                           
                            <div class="result-description">
                            	<i class="fa fa-map-marker"></i><i>{$value.NPO_City}{if="$value.NPO_State!=''"}, {$value.NPO_State}{/if} {if="$value.NPO_Zip!=''"}- {$value.NPO_Zip}{/if}{if="$value.CategoryName!=''"}&nbsp;&nbsp;<i class="fa fa-check-circle-o"></i>{$value.CategoryName|strip_tags}{/if}</i>
                            </div>
                            <div class="result-description">
                               {$value.LimitedDescription}
                               <span class="full-text dn">{$value.NextDescription|strBreakLine}</span>&nbsp;{if="$value.IsRegistered"}<br /><i class="icmo icmo-tree1"></i><span style="font-size:9px;">&nbsp;fully registered with donasity</span>{/if}                  
                            </div>
                            <div class="visible-xs pull-right"><a href='{#URL#}donation_checkout/index/addcart/{$value.NPO_ID|keyEncrypt}/{if="$value.IsRegistered==1"}NPOR{else}NPONR{/if}' class="t-green mt-0 f-18 button-1" title="Click here to donate now">DONATE >> </a></div>                          
                        </div>
                    </div> 
                     {/loop}
                     {else}
                    <div style="display:block;margin-top:10px;text-align:center;clear:both;">
                        {#NO_RECORD_FOUND#}
                    </div>
                    {/if}
                    <!-- npo listing -->                      
                      <!-- pagination start-->
                       <div class="row">
                           <div class="col-xs-12 mt-10">
                               {if condition="count($PagingList)>1"}
                               <nav>
                                  <ul class="pagination">
                                    {if="$PageSelected!=1"}
                                    <li>
                                      <a href='javascript://' onClick="return GotoPage(1);"  title="First Page" aria-label="Previous">
                                        <span aria-hidden="true">First</span>
                                      </a>
                                    </li>
                                    <li>
                                      <a href='javascript://' onClick="return GotoPage({$PageSelected-1});"  title="Previous" aria-label="Previous">
                                        <span aria-hidden="true">&laquo;</span>
                                      </a>
                                    </li>
                                    {/if}
                                    {loop="PagingList"} 
                                         {if="$PageSelected==$value.PageNo"} 
                                            <li class="active"><a href='javascript://' title="Page No {$value.PageNo}">{$value.PageNo}</a></li>
                                          {else}
                                            <li><a href='javascript://' onClick="return GotoPage({$value.PageNo});" title="Page No {$value.PageNo}">{$value.PageNo}</a></li>
                                          {/if}   
                                    {/loop}
                                    {if="$PageSelected!=$lastPage"}
                                        <li>
                                          <a href='javascript://' onClick="return GotoPage({$PageSelected+1});" aria-label="Next">
                                            <span aria-hidden="true">&raquo;</span>
                                          </a>
                                        </li>
                                        <li>
                                          <a href='javascript://' onClick="return GotoPage({$lastPage});" aria-label="Last Page">
                                           Last
                                          </a>
                                        </li>
                                    {/if}
                                  </ul>
                                </nav>
                                {/if}
                            </div>
                        </div>
                        <!-- pagination end-->                       
                </div>
            </div>
        </div>
    </div>
</section>
</form>
{include="bottom/bottom"}
</body>
</html>